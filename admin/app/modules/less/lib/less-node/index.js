var environment=require("./environment"),FileManager=require("./file-manager"),UrlFileManager=require("./url-file-manager"),createFromEnvironment=require("../less"),less=createFromEnvironment(environment,[new FileManager,new UrlFileManager]),lesscHelper=require("./lessc-helper");less.createFromEnvironment=createFromEnvironment,less.lesscHelper=lesscHelper,less.PluginLoader=require("./plugin-loader"),less.fs=require("./fs"),less.FileManager=FileManager,less.UrlFileManager=UrlFileManager,less.formatError=function(e,r){r=r||{};var n="",l=e.extract,s=[],i=r.color?lesscHelper.stylize:function(e){return e};if(e.stack&&!e.type)return i(e.stack,"red");if(!e.hasOwnProperty("index")||!l)return e.stack||e.message;if("string"==typeof l[0]&&s.push(i(e.line-1+" "+l[0],"grey")),"string"==typeof l[1]){var a=e.line+" ";l[1]&&(a+=l[1].slice(0,e.column)+i(i(i(l[1].substr(e.column,1),"bold")+l[1].slice(e.column+1),"red"),"inverse")),s.push(a)}return"string"==typeof l[2]&&s.push(i(e.line+1+" "+l[2],"grey")),s=s.join("\n")+i("","reset")+"\n",n+=i(e.type+"Error: "+e.message,"red"),e.filename&&(n+=i(" in ","red")+e.filename+i(" on line "+e.line+", column "+(e.column+1)+":","grey")),n+="\n"+s,e.callLine&&(n+=i("from ","red")+(e.filename||"")+"/n",n+=i(e.callLine,"grey")+" "+e.callExtract+"/n"),n},less.writeError=function(e,r){r=r||{},r.silent||console.error(less.formatError(e,r))},require("./image-size")(less.environment),module.exports=less;
