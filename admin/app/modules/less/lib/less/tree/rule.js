function evalName(e,t){var i,n="",r=t.length,a={add:function(e){n+=e}};for(i=0;i<r;i++)t[i].eval(e).genCSS(e,a);return n}var Node=require("./node"),Value=require("./value"),Keyword=require("./keyword"),Rule=function(e,t,i,n,r,a,o,l){this.name=e,this.value=t instanceof Node?t:new Value([t]),this.important=i?" "+i.trim():"",this.merge=n,this.index=r,this.currentFileInfo=a,this.inline=o||!1,this.variable=void 0!==l?l:e.charAt&&"@"===e.charAt(0),this.allowRoot=!0};Rule.prototype=new Node,Rule.prototype.type="Rule",Rule.prototype.genCSS=function(e,t){t.add(this.name+(e.compress?":":": "),this.currentFileInfo,this.index);try{this.value.genCSS(e,t)}catch(e){throw e.index=this.index,e.filename=this.currentFileInfo.filename,e}t.add(this.important+(this.inline||e.lastRule&&e.compress?"":";"),this.currentFileInfo,this.index)},Rule.prototype.eval=function(e){var t,i=!1,n=this.name,r=this.variable;"string"!=typeof n&&(n=1===n.length&&n[0]instanceof Keyword?n[0].value:evalName(e,n),r=!1),"font"!==n||e.strictMath||(i=!0,e.strictMath=!0);try{if(e.importantScope.push({}),t=this.value.eval(e),!this.variable&&"DetachedRuleset"===t.type)throw{message:"Rulesets cannot be evaluated on a property.",index:this.index,filename:this.currentFileInfo.filename};var a=this.important,o=e.importantScope.pop();return!a&&o.important&&(a=o.important),new Rule(n,t,a,this.merge,this.index,this.currentFileInfo,this.inline,r)}catch(e){throw"number"!=typeof e.index&&(e.index=this.index,e.filename=this.currentFileInfo.filename),e}finally{i&&(e.strictMath=!1)}},Rule.prototype.makeImportant=function(){return new Rule(this.name,this.value,"!important",this.merge,this.index,this.currentFileInfo,this.inline)},module.exports=Rule;
