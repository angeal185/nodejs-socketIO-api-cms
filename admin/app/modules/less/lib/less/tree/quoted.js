var Node=require("./node"),JsEvalNode=require("./js-eval-node"),Variable=require("./variable"),Quoted=function(e,t,o,i,u){this.escaped=null==o||o,this.value=t||"",this.quote=e.charAt(0),this.index=i,this.currentFileInfo=u};Quoted.prototype=new JsEvalNode,Quoted.prototype.type="Quoted",Quoted.prototype.genCSS=function(e,t){this.escaped||t.add(this.quote,this.currentFileInfo,this.index),t.add(this.value),this.escaped||t.add(this.quote)},Quoted.prototype.containsVariables=function(){return this.value.match(/(`([^`]+)`)|@\{([\w-]+)\}/)},Quoted.prototype.eval=function(e){function t(e,t,o){var i=e;do{e=i,i=e.replace(t,o)}while(e!==i);return i}var o=this,i=this.value,u=function(t,i){return String(o.evaluateJavaScript(i,e))},r=function(t,i){var u=new Variable("@"+i,o.index,o.currentFileInfo).eval(e,!0);return u instanceof Quoted?u.value:u.toCSS()};return i=t(i,/`([^`]+)`/g,u),i=t(i,/@\{([\w-]+)\}/g,r),new Quoted(this.quote+i+this.quote,i,this.escaped,this.index,this.currentFileInfo)},Quoted.prototype.compare=function(e){return"Quoted"!==e.type||this.escaped||e.escaped?e.toCSS&&this.toCSS()===e.toCSS()?0:void 0:Node.numericCompare(this.value,e.value)},module.exports=Quoted;
