var Node=require("./node"),unitConversions=require("../data/unit-conversions"),Unit=function(t,n,o){this.numerator=t?t.slice(0).sort():[],this.denominator=n?n.slice(0).sort():[],o?this.backupUnit=o:t&&t.length&&(this.backupUnit=t[0])};Unit.prototype=new Node,Unit.prototype.type="Unit",Unit.prototype.clone=function(){return new Unit(this.numerator.slice(0),this.denominator.slice(0),this.backupUnit)},Unit.prototype.genCSS=function(t,n){var o=t&&t.strictUnits;1===this.numerator.length?n.add(this.numerator[0]):!o&&this.backupUnit?n.add(this.backupUnit):!o&&this.denominator.length&&n.add(this.denominator[0])},Unit.prototype.toString=function(){var t,n=this.numerator.join("*");for(t=0;t<this.denominator.length;t++)n+="/"+this.denominator[t];return n},Unit.prototype.compare=function(t){return this.is(t.toString())?0:void 0},Unit.prototype.is=function(t){return this.toString().toUpperCase()===t.toUpperCase()},Unit.prototype.isLength=function(){return Boolean(this.toCSS().match(/px|em|%|in|cm|mm|pc|pt|ex/))},Unit.prototype.isEmpty=function(){return 0===this.numerator.length&&0===this.denominator.length},Unit.prototype.isSingular=function(){return this.numerator.length<=1&&0===this.denominator.length},Unit.prototype.map=function(t){var n;for(n=0;n<this.numerator.length;n++)this.numerator[n]=t(this.numerator[n],!1);for(n=0;n<this.denominator.length;n++)this.denominator[n]=t(this.denominator[n],!0)},Unit.prototype.usedUnits=function(){var t,n,o,i={};n=function(n){return t.hasOwnProperty(n)&&!i[o]&&(i[o]=n),n};for(o in unitConversions)unitConversions.hasOwnProperty(o)&&(t=unitConversions[o],this.map(n));return i},Unit.prototype.cancel=function(){var t,n,o={};for(n=0;n<this.numerator.length;n++)t=this.numerator[n],o[t]=(o[t]||0)+1;for(n=0;n<this.denominator.length;n++)t=this.denominator[n],o[t]=(o[t]||0)-1;this.numerator=[],this.denominator=[];for(t in o)if(o.hasOwnProperty(t)){var i=o[t];if(i>0)for(n=0;n<i;n++)this.numerator.push(t);else if(i<0)for(n=0;n<-i;n++)this.denominator.push(t)}this.numerator.sort(),this.denominator.sort()},module.exports=Unit;
