module.exports=function(e){var t=function(t){this._css=[],this._rootNode=t.rootNode,this._contentsMap=t.contentsMap,this._contentsIgnoredCharsMap=t.contentsIgnoredCharsMap,t.sourceMapFilename&&(this._sourceMapFilename=t.sourceMapFilename.replace(/\\/g,"/")),this._outputFilename=t.outputFilename,this.sourceMapURL=t.sourceMapURL,t.sourceMapBasepath&&(this._sourceMapBasepath=t.sourceMapBasepath.replace(/\\/g,"/")),t.sourceMapRootpath?(this._sourceMapRootpath=t.sourceMapRootpath.replace(/\\/g,"/"),"/"!==this._sourceMapRootpath.charAt(this._sourceMapRootpath.length-1)&&(this._sourceMapRootpath+="/")):this._sourceMapRootpath="",this._outputSourceFiles=t.outputSourceFiles,this._sourceMapGeneratorConstructor=e.getSourceMapGenerator(),this._lineNumber=0,this._column=0};return t.prototype.normalizeFilename=function(e){return e=e.replace(/\\/g,"/"),this._sourceMapBasepath&&0===e.indexOf(this._sourceMapBasepath)&&(e=e.substring(this._sourceMapBasepath.length),"\\"!==e.charAt(0)&&"/"!==e.charAt(0)||(e=e.substring(1))),(this._sourceMapRootpath||"")+e},t.prototype.add=function(e,t,s,o){if(e){var n,a,i,r,h;if(t){var p=this._contentsMap[t.filename];this._contentsIgnoredCharsMap[t.filename]&&(s-=this._contentsIgnoredCharsMap[t.filename],s<0&&(s=0),p=p.slice(this._contentsIgnoredCharsMap[t.filename])),p=p.substring(0,s),a=p.split("\n"),r=a[a.length-1]}if(n=e.split("\n"),i=n[n.length-1],t)if(o)for(h=0;h<n.length;h++)this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+h+1,column:0===h?this._column:0},original:{line:a.length+h,column:0===h?r.length:0},source:this.normalizeFilename(t.filename)});else this._sourceMapGenerator.addMapping({generated:{line:this._lineNumber+1,column:this._column},original:{line:a.length,column:r.length},source:this.normalizeFilename(t.filename)});1===n.length?this._column+=i.length:(this._lineNumber+=n.length-1,this._column=i.length),this._css.push(e)}},t.prototype.isEmpty=function(){return 0===this._css.length},t.prototype.toCSS=function(e){if(this._sourceMapGenerator=new this._sourceMapGeneratorConstructor({file:this._outputFilename,sourceRoot:null}),this._outputSourceFiles)for(var t in this._contentsMap)if(this._contentsMap.hasOwnProperty(t)){var s=this._contentsMap[t];this._contentsIgnoredCharsMap[t]&&(s=s.slice(this._contentsIgnoredCharsMap[t])),this._sourceMapGenerator.setSourceContent(this.normalizeFilename(t),s)}if(this._rootNode.genCSS(e,this),this._css.length>0){var o,n=JSON.stringify(this._sourceMapGenerator.toJSON());this.sourceMapURL?o=this.sourceMapURL:this._sourceMapFilename&&(o=this._sourceMapFilename),this.sourceMapURL=o,this.sourceMap=n}return this._css.join("")},t};
